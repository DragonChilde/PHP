# 卸载PHP

删除php的相关包及配置

```
$ sudo apt-get autoremove php7*
```

删除关联

```
$ sudo find /etc -name "*php*" |xargs  rm -rf 
```

清除dept列表

```
$ sudo apt purge `dpkg -l | grep php| awk '{print $2}' |tr "\n" " "`
```

检查是否卸载干净

```
$  dpkg -l | grep php
```

# 安装PHP7.3

```
$ sudo apt-get install python-software-properties
$ sudo add-apt-repository ppa:ondrej/php
$ sudo apt-get update
$ sudo apt-get install -y php7.3
```

# 安装PHP 7模块

你还可能需要根据你的应用程序需求安装模块。使用以下命令在包存储库中搜索可用的PHP 7模块。

```
$ sudo apt-cache search php7*
```

你可以按照下面的命令在系统上安装所需的PHP模块。通过指定带有包名的版本，确保安装正确的PHP版本的包。在不定义包版本的情况下，它将安装最新的包。

```
$ sudo apt-get install php7.3-mysql php7.3-curl php7.3-json php7.3-cgi php7.3-xsl
```

# 删除APACHE

如果安装了Apache，要先卸载Apache或者能够更换Apache的端口？卸载命令如下（新系统/没安装不必卸载）

```
$ service apache2 stop
$ sudo apt-get --purge remove apache2
$ sudo apt-get --purge remove apache2.2-common
$ sudo apt-get --purge remove libapache2-svn
$ sudo apt-get autoremove
```

（关键一步）找到没有删除掉的配置文件，一并删除

```
$ sudo find /etc -name "*apache*" -exec  rm -rf {} \;
```

# 安装Nginx

安装Nginx命令如下

```
$ apt-get -y install nginx
```

完成后，启动Nginx命令如下

```
$ service nginx start
```

输入IP地址或域名在浏览器访问，显示成功安装Nginx

# **配置Nginx**

打开配置文件nginx.conf 命令如下

```
vim /etc/nginx/nginx.conf
```

找到nginx.conf配置文件里的keepalive_timeout变量把它的值改成2，如下（如何修改文件内容，见本文开头常用命令vim）

```
http {

        ##
        # Basic Settings
        ##

        sendfile on;
        tcp_nopush on;
        tcp_nodelay on;
        keepalive_timeout 2;
        types_hash_max_size 2048;
        # server_tokens off;

        ......
```

接下来打开配置文件sites-available/default 命令如下

```
vim /etc/nginx/sites-available/default
```

打开后，按照如下部分修改（主要就是把前面"#"注释标志删掉，让PHP生效。注意函数的大括号“}”不要忘了取消注释）

```
server {
        listen 80 default_server;
        listen [::]:80 default_server;

        # SSL configuration
        #
        # See: https://bugs.debian.org/773332
        #
        # Read up on ssl_ciphers to ensure a secure configuration.
        # See: https://bugs.debian.org/765782
        #
        # Self signed certs generated by the ssl-cert package
        # Don't use them in a production server!
        #
        # include snippets/snakeoil.conf;

        root /var/www/html;

        # Add index.php to the list if you are using PHP
        index index.php index.html index.htm index.nginx-debian.html;

        server_name _;

        location / {
                # First attempt to serve request as file, then
                # as directory, then fall back to displaying a 404.
                try_files $uri $uri/ =404;
        }

        # pass PHP scripts to FastCGI server
        #
        location ~ \.php$ {
                include snippets/fastcgi-php.conf;
        #
        #       # With php-fpm (or other unix sockets):
                fastcgi_pass unix:/var/run/php/php7.3-fpm.sock;
        #       # With php-cgi (or other tcp sockets):
        #       fastcgi_pass 127.0.0.1:9000;
        }

        # deny access to .htaccess files, if Apache's document root
        # concurs with nginx's one
        #
        location ~ /\.ht {
                deny all;
        }
}
```

两个文件都修改完后，重新加载一下nginx 命令如下

```
$ service nginx reload
```

# **配置PHP**

这里要注意：php的配置文件php.ini，路径会随PHP版本而不同，所以首先查找php.ini文件位置 命令如下

```
$ php -i | grep php.ini
```

```
root@DESKTOP-933NN47:/var/www# php -i | grep php.ini
Configuration File (php.ini) Path => /etc/php/7.3/cli
Loaded Configuration File => /etc/php/7.3/cli/php.ini
```

命令的意思是：php -i 即显示php的详细信息，然后在其中匹配php.ini的信息，如上图找到了路径是 /etc/php/7.3/cli/php.ini，接下来就是打开这个文件

```
vim /etc/php/7.3/cli/php.ini
```

然后输入/cgi.fix_pathinfo 查询，找到后回车，按 I 进入编辑模式，修改文件内容cgi.fix_pathinfo = 0，记得前面的分号  ; （注释！）要删掉。

```
; cgi.fix_pathinfo provides *real* PATH_INFO/PATH_TRANSLATED support for CGI.  PHP's
; previous behaviour was to set PATH_TRANSLATED to SCRIPT_FILENAME, and to not grok
; what PATH_INFO is.  For more information on PATH_INFO, see the cgi specs.  Setting
; this to 1 will cause PHP CGI to fix its paths to conform to the spec.  A setting
; of zero causes PHP to behave as before.  Default is 1.  You should fix your scripts
; to use SCRIPT_FILENAME rather than PATH_TRANSLATED.
; http://php.net/cgi.fix-pathinfo
cgi.fix_pathinfo=0
```

修改完成后重新加载PHP服务命令如下（还是一样，根据自己版本号确定服务名。不知道自己服务名的输入以下命令查看

```
$ service --status-all
```

重启php7.3-fpm

```
$ service php7.2-fpm reload
```

建立phpinfo文件查看是否配置成功